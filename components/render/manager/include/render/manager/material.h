#ifndef RENDER_MANAGER_MATERIAL_HEADER
#define RENDER_MANAGER_MATERIAL_HEADER

#include <render/manager/texture.h>

namespace media
{

namespace rfx
{

//forward declaration
class Material;
class MaterialLibrary;
class EffectLibrary;
class ShaderLibrary;

}

}

namespace render
{

namespace manager
{

//implementation forwards
class MaterialImpl;
class Wrappers;

///////////////////////////////////////////////////////////////////////////////////////////////////
///Материал
///////////////////////////////////////////////////////////////////////////////////////////////////
class Material
{
  friend class Wrappers;
  public:
///////////////////////////////////////////////////////////////////////////////////////////////////
///Конструкторы / деструкторы / присваивание
///////////////////////////////////////////////////////////////////////////////////////////////////
    Material  (const Material&);
    ~Material ();
    
    Material& operator = (const Material&);

///////////////////////////////////////////////////////////////////////////////////////////////////
///Создание копии
///////////////////////////////////////////////////////////////////////////////////////////////////
    Material Clone () const;
    
///////////////////////////////////////////////////////////////////////////////////////////////////
///Имя материала
///////////////////////////////////////////////////////////////////////////////////////////////////
    const char* Name    () const;
    void        SetName (const char* id);

///////////////////////////////////////////////////////////////////////////////////////////////////
///Обновление материала
///////////////////////////////////////////////////////////////////////////////////////////////////
    void Update (const media::rfx::Material&);

///////////////////////////////////////////////////////////////////////////////////////////////////
///Обновление отдельных текстур
///////////////////////////////////////////////////////////////////////////////////////////////////
    void        SetTexmap        (const char* semantic, const char* image_name, const char* sampler);
    void        SetTexmapImage   (const char* semantic, const char* image_name);
    void        SetTexmapSampler (const char* semantic, const char* sampler);
    void        RemoveTexmap     (const char* semantic);
    const char* TexmapImage      (const char* semantic) const; //null if not exist
    const char* TexmapSampler    (const char* semantic) const; //null if not exist
    
///////////////////////////////////////////////////////////////////////////////////////////////////
///Управление кэшированием
///////////////////////////////////////////////////////////////////////////////////////////////////
    void UpdateCache ();
    void ResetCache  ();

///////////////////////////////////////////////////////////////////////////////////////////////////
///Обмен
///////////////////////////////////////////////////////////////////////////////////////////////////
    void Swap (Material&);

  private:
    Material (MaterialImpl*);
  
  private:
    MaterialImpl* impl;
};

///////////////////////////////////////////////////////////////////////////////////////////////////
///Обмен
///////////////////////////////////////////////////////////////////////////////////////////////////
void swap (Material&, Material&);

}

}

#endif
