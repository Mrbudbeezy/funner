///////////////////////////////////////////////////////////////////////////////////////////////////
///Режим сортировки примитивов в проходе
///////////////////////////////////////////////////////////////////////////////////////////////////
enum SortMode
{
  SortMode_FrontToBack, //сортировать от ближнего примитива к дальнему
  SortMode_BackToFront, //сортировать от дальнего примитива к ближнему
  SortMode_StateSwitch, //группировать примитивы с целью сокращения количества переключений состояний
};

///////////////////////////////////////////////////////////////////////////////////////////////////
///Проход эффект рендеринга
///////////////////////////////////////////////////////////////////////////////////////////////////
class EffectPass: public Object, public CacheSource
{
  public:
///////////////////////////////////////////////////////////////////////////////////////////////////
///Конструктор / деструктор
///////////////////////////////////////////////////////////////////////////////////////////////////
    EffectPass  (const DeviceManager& device_manager);
    ~EffectPass ();

///////////////////////////////////////////////////////////////////////////////////////////////////
///Состояния уровней устройства отрисовки
///////////////////////////////////////////////////////////////////////////////////////////////////
    void                                SetBlendState        (const LowLevelBlendStatePtr&);
    void                                SetDepthStencilState (const LowLevelDepthStencilStatePtr&);
    void                                SetRasterizerState   (const LowLevelRasterizerStatePtr&);
    const LowLevelBlendStatePtr&        BlendState           ();
    const LowLevelDepthStencilStatePtr& DepthStencilState    ();
    const LowLevelRasterizerStatePtr&   RasterizerState      ();    

///////////////////////////////////////////////////////////////////////////////////////////////////
///Тэги примитивов, которые войдут в проход
///////////////////////////////////////////////////////////////////////////////////////////////////
    void        SetTags (const char* tags);
    const char* Tags    ();

///////////////////////////////////////////////////////////////////////////////////////////////////
///Тип сортировки примитивов
///////////////////////////////////////////////////////////////////////////////////////////////////
    void             SetSortMode (render::SortMode mode);
    render::SortMode SortMode    ();
    
///////////////////////////////////////////////////////////////////////////////////////////////////
///Визуализация прохода
///////////////////////////////////////////////////////////////////////////////////////////////////
//    void Draw (const RenderContext& context);

  private:
    struct Impl;
    stl::auto_ptr<Impl> impl;
};

///////////////////////////////////////////////////////////////////////////////////////////////////
///Эффект рендеринга
///////////////////////////////////////////////////////////////////////////////////////////////////
class EffectFrame: public Object, public CacheSource
{
  public:
///////////////////////////////////////////////////////////////////////////////////////////////////
///Конструктор / деструктор
///////////////////////////////////////////////////////////////////////////////////////////////////
    EffectFrame  (const DeviceManager& device_manager);
    ~EffectFrame ();

///////////////////////////////////////////////////////////////////////////////////////////////////
///Проходы рендеринга / вложенные эффекты
///////////////////////////////////////////////////////////////////////////////////////////////////
    size_t PassesCount         ();
    size_t ChildrenCount       ();
    size_t AddOperation        (const EffectPassPtr&); //returns order number of operation in rendering sequence
    size_t AddOperation        (const EffectFramePtr&); //returns order number of operation in rendering sequence
    void   RemoveOperation     (size_t order_number);
    void   RemoveAllOperations ();

///////////////////////////////////////////////////////////////////////////////////////////////////
///Визуализация кадра
///////////////////////////////////////////////////////////////////////////////////////////////////
//    void Draw (const RenderContext& context);

  private:
    struct Impl;
    stl::auto_ptr<Impl> impl;
};
