///////////////////////////////////////////////////////////////////////////////////////////////////
///Окно рендеринга
///////////////////////////////////////////////////////////////////////////////////////////////////
class WindowImpl: public Object, public xtl::trackable
{
  public:
///////////////////////////////////////////////////////////////////////////////////////////////////
///Конструктор / деструктор
///////////////////////////////////////////////////////////////////////////////////////////////////
    WindowImpl  (const DeviceManagerPtr&, syslib::Window&, const common::PropertyMap&, const SettingsPtr&, const CacheManagerPtr&);
    ~WindowImpl ();    
    
///////////////////////////////////////////////////////////////////////////////////////////////////
///Менеджер устройства
///////////////////////////////////////////////////////////////////////////////////////////////////
    DeviceManagerPtr& DeviceManager ();
    
///////////////////////////////////////////////////////////////////////////////////////////////////
///Идентификатор окна
///////////////////////////////////////////////////////////////////////////////////////////////////
    void        SetName   (const char* name);
    const char* Name      ();

///////////////////////////////////////////////////////////////////////////////////////////////////
///Цели рендеринга
///////////////////////////////////////////////////////////////////////////////////////////////////
    const RenderTargetPtr& ColorBuffer        ();
    const RenderTargetPtr& DepthStencilBuffer ();

///////////////////////////////////////////////////////////////////////////////////////////////////
///Размеры целей рендеринга
///////////////////////////////////////////////////////////////////////////////////////////////////
    size_t Width  ();
    size_t Height ();

///////////////////////////////////////////////////////////////////////////////////////////////////
///Регистрация обработчиков событий
///////////////////////////////////////////////////////////////////////////////////////////////////
    typedef Window::EventHandler EventHandler;

    xtl::connection RegisterEventHandler (WindowEvent event, const EventHandler& handler) const;
    
///////////////////////////////////////////////////////////////////////////////////////////////////
///Принудительное обновление содержимого окна (обмен буферов)
///////////////////////////////////////////////////////////////////////////////////////////////////
    void SwapBuffers ();    

  private:
    struct Impl;
    stl::auto_ptr<Impl> impl;
};
