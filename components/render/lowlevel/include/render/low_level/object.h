#ifndef RENDER_LOW_LEVEL_OBJECT_HEADER
#define RENDER_LOW_LEVEL_OBJECT_HEADER

#include <xtl/functional_fwd>
#include <xtl/trackable.h> //убрать зависимость!!!

namespace render
{

namespace low_level
{

//forward declaration
class IDevice;
class IPropertyList;

///////////////////////////////////////////////////////////////////////////////////////////////////
///Базовый класс семейства низкоуровневых классов отрисовки
///////////////////////////////////////////////////////////////////////////////////////////////////
class IObject
{
  public:
///////////////////////////////////////////////////////////////////////////////////////////////////
///Получение списка свойств объекта
///////////////////////////////////////////////////////////////////////////////////////////////////
    virtual IPropertyList* GetProperties () = 0;

///////////////////////////////////////////////////////////////////////////////////////////////////
///Подсчёт ссылок
///////////////////////////////////////////////////////////////////////////////////////////////////
    virtual void AddRef  () = 0;
    virtual void Release () = 0;

///////////////////////////////////////////////////////////////////////////////////////////////////
///Получение trackable
///////////////////////////////////////////////////////////////////////////////////////////////////
    virtual xtl::trackable& GetTrackable () = 0;

///////////////////////////////////////////////////////////////////////////////////////////////////
///Регистрация обработчиков события удаления объекта
///////////////////////////////////////////////////////////////////////////////////////////////////
    virtual xtl::connection RegisterDestroyHandler (xtl::trackable::slot_type& handler) = 0;
    virtual xtl::connection RegisterDestroyHandler (const xtl::trackable::function_type& handler) = 0;
    virtual xtl::connection RegisterDestroyHandler (const xtl::trackable::function_type& handler, xtl::trackable& trackable) = 0;

  protected:
    virtual ~IObject () {}

  private:
    IObject& operator = (const IObject&); //no impl
};

///////////////////////////////////////////////////////////////////////////////////////////////////
///Получение trackable
///////////////////////////////////////////////////////////////////////////////////////////////////
inline xtl::trackable& get_trackable (IObject& object)
{
  return object.GetTrackable ();
}

}

}

#endif
