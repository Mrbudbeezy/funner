#ifndef RENDER_SCENE_RENDER_MANAGER_HEADER
#define RENDER_SCENE_RENDER_MANAGER_HEADER

#include <xtl/functional_fwd>

namespace render
{

namespace mid_level
{

//forward declaration
class IRenderer;

}

//forward declaration
class Viewport;

///////////////////////////////////////////////////////////////////////////////////////////////////
///Интерфейс рендера сцены
///////////////////////////////////////////////////////////////////////////////////////////////////
class ICustomSceneRender
{
  public:
///////////////////////////////////////////////////////////////////////////////////////////////////
///Рисование сцены
///////////////////////////////////////////////////////////////////////////////////////////////////
    virtual void Render (const Viewport& viewport) = 0;

///////////////////////////////////////////////////////////////////////////////////////////////////
///Подсчёт ссылок
///////////////////////////////////////////////////////////////////////////////////////////////////
    virtual void AddRef  () = 0;
    virtual void Release () = 0;

  protected:
    virtual ~ICustomSceneRender () {}
};

///////////////////////////////////////////////////////////////////////////////////////////////////
///Менеджер рендеров сцены
///////////////////////////////////////////////////////////////////////////////////////////////////
class SceneRenderManager
{
  public:
    typedef xtl::function<ICustomSceneRender* (mid_level::IRenderer* renderer, const char* path_name)> RenderCreater;

///////////////////////////////////////////////////////////////////////////////////////////////////
///Регистрация путей рендеринга
///////////////////////////////////////////////////////////////////////////////////////////////////
    static void RegisterRender       (const char* path_name, const RenderCreater& creater);
    static void UnregisterRender     (const char* path_name);
    static void UnregisterAllRenders ();
    
///////////////////////////////////////////////////////////////////////////////////////////////////
///Перебор путей рендеринга
///////////////////////////////////////////////////////////////////////////////////////////////////
    static size_t      PathsCount ();
    static const char* PathName   (size_t index);
};

}

#endif
