#ifndef MEDIALIB_ADOBE_XFL_LOADER_SHARED_HEADER
#define MEDIALIB_ADOBE_XFL_LOADER_SHARED_HEADER

#include <stl/string>

#include <xtl/common_exceptions.h>

#include <common/component.h>
#include <common/log.h>
#include <common/parser.h>
#include <common/strlib.h>

#include <media/adobe/xfl.h>

namespace media
{

namespace adobe
{

namespace xfl
{

///////////////////////////////////////////////////////////////////////////////////////////////////
///Загрузчик xfl файлов
///////////////////////////////////////////////////////////////////////////////////////////////////
class XflParser
{
  public:    
///////////////////////////////////////////////////////////////////////////////////////////////////
///Конструктор
///////////////////////////////////////////////////////////////////////////////////////////////////
    XflParser  (const char* file_name, const char* path_prefix, Document& document);
    ~XflParser ();

  private:
///////////////////////////////////////////////////////////////////////////////////////////////////
///Печать лога парсинга
///////////////////////////////////////////////////////////////////////////////////////////////////
    void PrintLog ();

///////////////////////////////////////////////////////////////////////////////////////////////////
///Разбор отдельных элементов
///////////////////////////////////////////////////////////////////////////////////////////////////
    void ParseRoot      (common::Parser::Iterator);
    void ParseLibraries (common::Parser::Iterator);

  private:
    Document&      document;    //загружаемый документ
    common::Parser parser;      //парсер
    common::Log    log;         //протокол
    stl::string    path_prefix; //путь к xfl архиву
};

}

}

}

#endif
