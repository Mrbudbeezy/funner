#ifndef MEDIALIB_ANIMATION_STATE_HEADER
#define MEDIALIB_ANIMATION_STATE_HEADER

namespace xtl
{

//forward declaration
class trackable;

}

namespace media
{

namespace animation
{

///////////////////////////////////////////////////////////////////////////////////////////////////
///Интерфейс состояния анимации
///////////////////////////////////////////////////////////////////////////////////////////////////
class IAnimationState
{
  public:
///////////////////////////////////////////////////////////////////////////////////////////////////
///Получение времени и веса
///////////////////////////////////////////////////////////////////////////////////////////////////
    virtual float Time   () = 0;
    virtual float Weight () = 0;

  protected:
    virtual ~IAnimationState () {}
};

///////////////////////////////////////////////////////////////////////////////////////////////////
///Состояние анимации
///////////////////////////////////////////////////////////////////////////////////////////////////
class AnimationState
{
  public:
///////////////////////////////////////////////////////////////////////////////////////////////////
///Конструкторы / деструктор / присваивание
///////////////////////////////////////////////////////////////////////////////////////////////////
    AnimationState  ();
    AnimationState  (const AnimationState&);
    ~AnimationState ();

    AnimationState& operator = (const AnimationState&);
    
///////////////////////////////////////////////////////////////////////////////////////////////////
///Идентификатор
///////////////////////////////////////////////////////////////////////////////////////////////////
    size_t Id () const;

///////////////////////////////////////////////////////////////////////////////////////////////////
///Текущее время
///////////////////////////////////////////////////////////////////////////////////////////////////
    void  SetTime (float time);
    float Time    () const;
    
///////////////////////////////////////////////////////////////////////////////////////////////////
///Вес анимации
///////////////////////////////////////////////////////////////////////////////////////////////////
    void  SetWeight (float weight);
    float Weight    () const;

///////////////////////////////////////////////////////////////////////////////////////////////////
///Получение интерфейса состояния анимации (общий для всех копий AnimationState)
///////////////////////////////////////////////////////////////////////////////////////////////////
    IAnimationState& AnimationStateCore () const;

///////////////////////////////////////////////////////////////////////////////////////////////////
///Получение объекта оповещения об удалении
///////////////////////////////////////////////////////////////////////////////////////////////////
    xtl::trackable& GetTrackable () const;

///////////////////////////////////////////////////////////////////////////////////////////////////
///Обмен
///////////////////////////////////////////////////////////////////////////////////////////////////
    void Swap (AnimationState&);

  private:
    struct Impl;
    Impl* impl;
};

///////////////////////////////////////////////////////////////////////////////////////////////////
///Обмен
///////////////////////////////////////////////////////////////////////////////////////////////////
void swap (AnimationState&, AnimationState&);

///////////////////////////////////////////////////////////////////////////////////////////////////
///Получение объекта оповещения об удалении
///////////////////////////////////////////////////////////////////////////////////////////////////
xtl::trackable& get_trackable (const AnimationState&);

}

}

#endif
