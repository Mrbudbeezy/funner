//forward declaration
ref class ChildFormImpl;

///////////////////////////////////////////////////////////////////////////////////////////////////
///Дочерняя форма
///////////////////////////////////////////////////////////////////////////////////////////////////
class ChildForm: public Form
{
  public:
    typedef xtl::intrusive_ptr<ChildForm> Pointer;

///////////////////////////////////////////////////////////////////////////////////////////////////
///Деструктор
///////////////////////////////////////////////////////////////////////////////////////////////////
    ~ChildForm ();

///////////////////////////////////////////////////////////////////////////////////////////////////
///Создание формы
///////////////////////////////////////////////////////////////////////////////////////////////////
    static Pointer Create (windows_forms::WindowSystem& window_system, const char* init_string);

///////////////////////////////////////////////////////////////////////////////////////////////////
///Регистрация шлюзов
///////////////////////////////////////////////////////////////////////////////////////////////////
    static void RegisterInvokers (script::Environment&, const char* library_name, const char* base_library_name);

  private:
///////////////////////////////////////////////////////////////////////////////////////////////////
///Конструктор
///////////////////////////////////////////////////////////////////////////////////////////////////
    ChildForm (windows_forms::WindowSystem& window_system, const char* init_string);

///////////////////////////////////////////////////////////////////////////////////////////////////
///Получение ref-указателя формы
///////////////////////////////////////////////////////////////////////////////////////////////////
    System::Windows::Forms::Form^ FormHandle ();

  private:
    typedef msclr::gcroot<ChildFormImpl^>    HandlePtr;
    typedef xtl::com_ptr<ICustomChildWindow> ChildWindowPtr;

  private:
    HandlePtr      form;         //дескриптор формы
    ChildWindowPtr child_window; //дочернее окно, включенное в форму
};
