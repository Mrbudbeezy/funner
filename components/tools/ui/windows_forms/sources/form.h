///////////////////////////////////////////////////////////////////////////////////////////////////
///Базовый класс формы
///////////////////////////////////////////////////////////////////////////////////////////////////
class Form: public xtl::reference_counter, public xtl::dynamic_cast_root
{
  public:
    typedef msclr::gcroot<System::Windows::Forms::Form^> HandlePtr;
    typedef xtl::intrusive_ptr<Form>                     Pointer;

///////////////////////////////////////////////////////////////////////////////////////////////////
///Конструктор / деструктор
///////////////////////////////////////////////////////////////////////////////////////////////////
    Form (WindowSystem& window_system, const HandlePtr& form);

///////////////////////////////////////////////////////////////////////////////////////////////////
///Изменение текста формы
///////////////////////////////////////////////////////////////////////////////////////////////////
    void        SetText (const char*);
    const char* Text    ();

///////////////////////////////////////////////////////////////////////////////////////////////////
///Управление видимостью формы
///////////////////////////////////////////////////////////////////////////////////////////////////
    void Show ();
    void Hide ();
    void SetVisible (bool state);
    bool IsVisible ();

///////////////////////////////////////////////////////////////////////////////////////////////////
///Установка меню
///////////////////////////////////////////////////////////////////////////////////////////////////
    void                      SetMenuStrip (windows_forms::MenuStrip*);
    windows_forms::MenuStrip* MenuStrip    () { return menu_strip; }

///////////////////////////////////////////////////////////////////////////////////////////////////
///Добавление / удаление панели кнопок
///////////////////////////////////////////////////////////////////////////////////////////////////
    void Insert (windows_forms::ToolStrip*);
    void Remove (windows_forms::ToolStrip*);
    
///////////////////////////////////////////////////////////////////////////////////////////////////
///Регистрация шлюзов
///////////////////////////////////////////////////////////////////////////////////////////////////
    static void RegisterInvokers (script::Environment&);

  private:
    WindowSystem&             window_system; //оконная система
    HandlePtr                 form;          //дескриптор формы
    windows_forms::MenuStrip* menu_strip;    //цепочка меню формы
    AutoString                text;          //текст формы
};

///////////////////////////////////////////////////////////////////////////////////////////////////
///Создание форм
///////////////////////////////////////////////////////////////////////////////////////////////////
Form::Pointer create_main_form (WindowSystem& window_system); //создание главной формы
