//forward declaration
ref class ApplicationServerImpl;

///////////////////////////////////////////////////////////////////////////////////////////////////
///Менеджер плагинов
///////////////////////////////////////////////////////////////////////////////////////////////////
class PluginManager: public xtl::noncopyable
{
  public:
///////////////////////////////////////////////////////////////////////////////////////////////////
///Конструктор/деструктор
///////////////////////////////////////////////////////////////////////////////////////////////////
    PluginManager (WindowSystem& window_system);
    ~PluginManager ();

///////////////////////////////////////////////////////////////////////////////////////////////////
///Загрузка/выгрузка плагинов
///////////////////////////////////////////////////////////////////////////////////////////////////
    void LoadPlugins   (const char* wc_mask);
    void UnloadPlugins (const char* wc_mask);

///////////////////////////////////////////////////////////////////////////////////////////////////
///Загрузка конфигурации
///////////////////////////////////////////////////////////////////////////////////////////////////
    void LoadConfiguration (System::Xml::XmlNode^ configuration);

///////////////////////////////////////////////////////////////////////////////////////////////////
///Создание формы
///////////////////////////////////////////////////////////////////////////////////////////////////
    ChildForm::Pointer CreateForm (const char* plugin, const char* init_string);

  private:
    typedef msclr::gcroot<ApplicationServerImpl^> ApplicationServerPtr;

  private:
    WindowSystem*        window_system;      //оконная система
    common::Log          log;                //лог
    ApplicationServerPtr application_server; //интерфейс приложения
};
