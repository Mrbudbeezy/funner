//forward declaration
ref class MainFormImpl;

///////////////////////////////////////////////////////////////////////////////////////////////////
///Главная форма
///////////////////////////////////////////////////////////////////////////////////////////////////
class MainForm: public Form
{
  public:
    typedef xtl::intrusive_ptr<MainForm> Pointer;

///////////////////////////////////////////////////////////////////////////////////////////////////
///Деструктор
///////////////////////////////////////////////////////////////////////////////////////////////////
    ~MainForm ();

///////////////////////////////////////////////////////////////////////////////////////////////////
///Создание формы
///////////////////////////////////////////////////////////////////////////////////////////////////
    static Pointer Create (windows_forms::WindowSystem& window_system);

///////////////////////////////////////////////////////////////////////////////////////////////////
///Добавление дочерней формы
///////////////////////////////////////////////////////////////////////////////////////////////////
    void Insert (WeifenLuo::WinFormsUI::Docking::DockContent^);

///////////////////////////////////////////////////////////////////////////////////////////////////
///Регистрация шлюзов
///////////////////////////////////////////////////////////////////////////////////////////////////
    static void RegisterInvokers (script::Environment&, const char* base_library_name, const char* library_name);

  private:
///////////////////////////////////////////////////////////////////////////////////////////////////
///Конструктор
///////////////////////////////////////////////////////////////////////////////////////////////////
    MainForm (windows_forms::WindowSystem& window_system);

  private:
    typedef msclr::gcroot<MainFormImpl^> HandlePtr;    

  private:
    HandlePtr form; //дескриптор формы
};
