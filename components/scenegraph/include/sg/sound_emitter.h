#ifndef SCENE_GRAPH_SOUND_EMITTER_HEADER
#define SCENE_GRAPH_SOUND_EMITTER_HEADER

#include <mathlib.h>
#include <xtl/functional_fwd>
#include <sg/entity.h>

namespace scene_graph
{

///////////////////////////////////////////////////////////////////////////////////////////////////
///События источника звука
///////////////////////////////////////////////////////////////////////////////////////////////////
enum SoundEmitterEvent
{
  SoundEmitterEvent_Play,     //срабатывает при начале проигрывания
  SoundEmitterEvent_Stop,     //срабатывает при остановке проигрывания

  SoundEmitterEvent_Num
};

///////////////////////////////////////////////////////////////////////////////////////////////////
///Источник звука
///////////////////////////////////////////////////////////////////////////////////////////////////
class SoundEmitter : public Entity
{
  public:  
///////////////////////////////////////////////////////////////////////////////////////////////////
///Создание источника звука
///////////////////////////////////////////////////////////////////////////////////////////////////
    static SoundEmitter* Create (const char* sound_declaration_name);

///////////////////////////////////////////////////////////////////////////////////////////////////
///Имя звука
///////////////////////////////////////////////////////////////////////////////////////////////////
    const char* SoundDeclarationName () const;

///////////////////////////////////////////////////////////////////////////////////////////////////
///Проигрывание
///////////////////////////////////////////////////////////////////////////////////////////////////
    void Play ();
    void Stop ();

///////////////////////////////////////////////////////////////////////////////////////////////////
///Подписка на события SoundEmitter
///////////////////////////////////////////////////////////////////////////////////////////////////
    typedef xtl::signal<void (SoundEmitter& sender, SoundEmitterEvent event), xtl::default_signal_accumulator<void> > Signal;

    Signal& Event (SoundEmitterEvent) const;

  protected:
///////////////////////////////////////////////////////////////////////////////////////////////////
///Конструктор / деструктор
///////////////////////////////////////////////////////////////////////////////////////////////////
    SoundEmitter  (const char* sound_declaration_name);
    ~SoundEmitter ();

///////////////////////////////////////////////////////////////////////////////////////////////////
///Метод, вызываемый при посещении данного объекта
///////////////////////////////////////////////////////////////////////////////////////////////////
    void AcceptCore (Visitor&);

  private:
    struct Impl;
    Impl* impl;
};

}

#endif
