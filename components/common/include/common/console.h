#ifndef COMMONLIB_CONSOLE_HEADER
#define COMMONLIB_CONSOLE_HEADER

#include <cstdarg>

#include <xtl/functional_fwd>

namespace common
{

///////////////////////////////////////////////////////////////////////////////////////////////////
///События консоли
///////////////////////////////////////////////////////////////////////////////////////////////////
enum ConsoleEvent
{
  ConsoleEvent_OnPrint,     //срабатывает при вызове Print
  ConsoleEvent_OnPrintLine, //срабатывает при выводе полной строки

  ConsoleEvent_Num
};

///////////////////////////////////////////////////////////////////////////////////////////////////
///Консоль
///////////////////////////////////////////////////////////////////////////////////////////////////
class Console
{
  public:
///////////////////////////////////////////////////////////////////////////////////////////////////
///Обработчик сообщений
///////////////////////////////////////////////////////////////////////////////////////////////////
    typedef xtl::function<void (const char*)> EventHandler;

///////////////////////////////////////////////////////////////////////////////////////////////////
///Печать сообщений
///////////////////////////////////////////////////////////////////////////////////////////////////
    static void Print   (const char* message);
    static void Printf  (const char* message, ...);
    static void VPrintf (const char* message, va_list list);

///////////////////////////////////////////////////////////////////////////////////////////////////
///Регистрация обработчиков событий консоли
///////////////////////////////////////////////////////////////////////////////////////////////////
    static xtl::connection RegisterEventHandler (ConsoleEvent event, const EventHandler& handler);

///////////////////////////////////////////////////////////////////////////////////////////////////
///Максимальное количество строк сообщений
///////////////////////////////////////////////////////////////////////////////////////////////////
    static void   SetMaxLinesCount (size_t lines_count);
    static size_t MaxLinesCount    ();

///////////////////////////////////////////////////////////////////////////////////////////////////
///Перечисление строк консоли
///////////////////////////////////////////////////////////////////////////////////////////////////
    static size_t      LinesCount ();
    static const char* Message    (size_t line_index);
};

}

#endif
